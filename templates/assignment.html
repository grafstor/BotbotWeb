{% extends 'base.html' %}

{% block content %}
<div class="actions">
    <a href="{{ url_for('subject_page', subject_id=subject['id']) }}" class="btn-link">&lt; {{ subject['name'] }}</a>
</div>
<h1>{{ assignment_name }}</h1>

<p>Progress: {{ progress_percentage | round() }}% ({{ correct_answers }}/{{ total_answers }})</p>

<div class="actions">
    <a href="{{ url_for('statistics', assignment_id=assignment_id) }}" class="btn-link">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a>
    <form action="{{ url_for('reset_progress', assignment_id=assignment_id) }}" class="btn-link" method="post" style="display: inline;">
        <button type="submit" class="btn-link" onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å?');">
            –û—á–∏—Å—Ç–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
        </button>
    </form>
    {% if is_creator or role == '–∞–¥–º–∏–Ω' %}
        <form action="{{ url_for('delete_assignment', assignment_id=assignment_id) }}" method="post" style="display:inline;">
        <button type="submit" class="btn-link" onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ –∑–∞–¥–∞–Ω–∏–µ?');">
            –£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ
        </button>
        </form>
        <a href="{{ url_for('edit_assignment', assignment_id=assignment_id) }}" class="btn-link">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
     {% endif %}
</div>
<!-- <h2 style="opacity: 0;">–ó–∞–¥–∞–Ω–∏—è</h2> -->
{% if question %}
    <form action="{{ url_for('assignment_page', assignment_id=assignment_id) }}" method="post">
        <h2>{{ question['question_text']|safe }}</h2>
        <input type="hidden" name="question_id" value="{{ question['id'] }}">

        {% if answers|length == 1 or answers|selectattr('status', 'equalto', '–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π')|list|length == 1 %}

            <div class="single-answer">
                {% for answer in answers %}
                    <button type="submit" name="answers" value="{{ answer['id'] }}" class="btn btn-answer button_basic">
                        {{ answer['answer_text'] }}
                    </button>
                {% endfor %}
            </div>
        {% else %}

            <div class="multiple-answers">
        {% for answer in answers %}
        <div class="checkbox-wrapper">
            <input type="checkbox" id="answer_{{ answer['id'] }}" name="answers" value="{{ answer['id'] }}">
            <label for="answer_{{ answer['id'] }}" class="btn btn-answer button_basic">
                {{ answer['answer_text'] }}
            </label>
        </div>
        {% endfor %}

            </div>
            <button type="submit" class="card_button">–û—Ç–≤–µ—Ç–∏—Ç—å</button>
        {% endif %}
    </form>
{% endif %}


{% if correct_answer_text %}
    
        {% if is_correct %}
            <div style="color: #1FDA57;">–ü—Ä–∞–≤–∏–ª—å–Ω–æ! üåù</div>
        {% else %}
            <div style="color: #DA251F;">–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ! üåö</div>
        {% endif %}

        <h2>{{ correct_answer_text }}</h2>
        <a href="{{ url_for('assignment_page', assignment_id=assignment_id) }}" 
           class="card_button" >
           –°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å
        </a>
{% endif %}



{% endblock %}
